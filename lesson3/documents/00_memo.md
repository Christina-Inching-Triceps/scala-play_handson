# ドキュメントに落とす前のメモ

- DBにUserを追加する
  - modelの作成
- User登録画面を作成
- ログイン機能を作成
  - ActionBuilderを作成
  - AuthRequestみたいなのを作成
    - 型付でデータを取れるように
  - Refinerなどでチェインできるか確認
- ログアウト機能を作成

## ハンズオンのアジェンダ

- ActionBuilder使わずにログインして、セッションの動きを見る
- ActionBuilderでclassを作ってDIして認証を通す形で、一通りの機能を全部作る
  - ログインページにはログアウトボタンがない、他はある、みたいに決め打ちでいったん作る
- 発展問題として、ログインしている、していないで画面の表示を変えるようなものを作る

## 認証処理のパターン

- ActionBuilderを使わずにコツコツ頑張るパターン
  - 最初に認証を作るのには良いが、認証を通す処理を毎回書くのでだるい
- ActionBuilderを継承したClassを作成してDIして、呼び出すパターン
  - 一番バランスが良い
  - 課題
    - DIした変数名がlower camelだと、呼び出しがちょっとダサい。Action { req => } と合わ無いので違和感がでる
- ActionBuilderを継承して、認証ロジックは外出し出来るようにしているパターン
  - 課題
    - executionContextをControllerから注入しようとするとasyncじゃないときに呼び出しが冗長になる。Scalaの言語仕様上多分仕方がない
    - ちょっと複雑。個人で趣味の開発をする場合に、ここまでする意味があまりない

## 認証パターンについて考慮

- 未ログインでのみアクセスできる画面
  - 例) ログインページ
- ログイン済でのみアクセスできる画面
  - 例) マイページ
- 未ログイン、ログイン済それぞれでアクセス可能で画面上のパーツが違うもの
  - 例) Twitterのタイムライン
    - ログインしてなくても見れるが、一部ボタンが効かない、存在しないなど

## TODO

- ログアウトボタンの制御を自動化したいが、結構むずい
  - ログイン認証でリダイレクトせずにユーザリクエストを取れたり取れなかったりの奴が必要

